import{_ as E,f as S,m as A,r as u,o as a,c as d,a as s,b as n,w as v,F as _,g as P,k as U,H as I,i as N,t as c,j as b,h as j,d as M,n as p}from"./index-G37FbWeX.js";import{C as y}from"./CartStore-5NoZYp9z.js";import{S as h}from"./sweetalert2.all-0C7aQ452.js";var B={VITE_APP_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_API_NAME:"leo535",BASE_URL:"/flash-taste/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:x,VITE_APP_API_NAME:V}=B,F={data(){return{couponCode:"",discountStatus:!1,discount:0,form:{email:"",name:"",phone:"",address:"",msg:"",region:""}}},methods:{...S(y,["getCarts"]),sendCoupon(l){const e={code:l};this.$http.post(`${x}/api/${V}/coupon`,{data:e}).then(r=>{this.discountStatus=r.data.success,this.discount=Math.round(this.final_total-this.total),h.fire({position:"top-end",icon:"success",title:"已套用優惠券",showConfirmButton:!1,timer:1500}),this.couponCode=""}).catch(r=>(h.fire({position:"top-end",icon:"error",title:r.response.data.message,showConfirmButton:!1,timer:1500}),0))},sendOrder(){const l={user:{name:this.form.name,email:this.form.email,tel:this.form.phone,address:this.form.address},message:this.form.msg};this.axios.post(`${x}/api/${V}/order`,{data:l}).then(e=>{const r=this.$loading.show();console.log(e.data),h.fire({position:"top-end",icon:"success",title:e.data.message,showConfirmButton:!1,timer:1500}),this.$refs.form.resetForm(),this.getCarts(),r.hide(),this.$router.push(`/complete/${e.data.orderId}`)}).catch(e=>{h.fire({position:"top-end",icon:"error",title:e.response.data.message,showConfirmButton:!1,timer:1500})})}},computed:{...A(y,["carts","total","cartNum","final_total"])},mounted(){this.getCarts()}},T={class:"container"},q={class:"pt-4 pb-3 mb-3"},D=j('<div class="row justify-content-center"><div class="col-9 col-md-7 timeline"></div></div><div class="row mb-2"><div class="col-3 col-md-5"><div class="timeline-pointer text-center step-1 active"><p>購物清單確認</p></div></div><div class="col-6 col-md-2"><div class="timeline-pointer text-center step-2 active"><p>填寫訂單</p></div></div><div class="col-3 col-md-5"><div class="timeline-pointer text-center step-3"><p>購物完成</p></div></div></div>',2),O=s("span",{class:"material-icons"},"keyboard_return",-1),R={class:"order-details p-4"},L=s("h4",null,"訂單明細",-1),z={class:"order-item"},H={class:"row"},X={class:"col-md-6"},G={class:"p-2 shadow-sm h-100"},J=s("h3",{class:"text-center fw-bold text-primary"},"訂單項目",-1),K={class:"col-md-4"},Q=["src","alt"],W={class:"col-md-8 d-flex justify-content-center flex-md-column border border-1 p-2"},Y={class:""},Z={class:"fs-5 fs-md-4"},$={class:"d-flex"},ss={class:"ms-2"},es={class:"d-flex"},ts=s("span",null,"售價",-1),os={key:0,class:"d-flex justify-content-between text-success"},ls=s("small",null,"折扣價",-1),ns={class:"form-group"},is=s("label",{for:"coupon"},"優惠碼：",-1),as={class:"input-group mb-3"},ds={key:1,class:"text-center"},cs=s("h2",null,"目前無資料",-1),rs=[cs],ms={class:"row"},us={class:"fs-5"},_s=s("span",{class:"d-block fw-bold text-success"},"已套用優惠券",-1),ps={class:"d-flex justify-content-between"},fs=s("span",null,"原價:",-1),hs={class:"text-success"},vs={class:"d-flex justify-content-between"},bs=s("span",null,"折扣價:",-1),gs={class:"text-success"},ys={class:"d-flex justify-content-between"},xs=s("span",null,"總計:",-1),Vs={key:0,class:"d-flex justify-content-between"},ws=s("span",null,"總計:",-1),ks={class:"text-danger"},Cs={class:"p-2"},Es=s("h3",{class:"text-center fw-bold text-primary"},"訂單資訊",-1),Ss={class:"mb-3"},As=s("span",{class:"text-danger me-1"},"*",-1),Ps=s("label",{for:"customer-name",class:"form-label"},"姓名",-1),Us={class:"mb-3"},Is=s("span",{class:"text-danger me-1"},"*",-1),Ns=s("label",{for:"customer-emall",class:"form-label"},"Email",-1),js={class:"mb-3"},Ms=s("span",{class:"text-danger me-1"},"*",-1),Bs=s("label",{for:"customer-phone",class:"form-label"},"電話",-1),Fs={class:"mb-3"},Ts=s("span",{class:"text-danger me-1"},"*",-1),qs=s("label",{for:"customer-address",class:"form-label"},"地址",-1),Ds=s("span",{class:"text-danger me-1"},"*",-1),Os=s("label",{for:"customer-pay",class:"form-label"},"付款方式",-1),Rs=s("option",{value:"",disabled:""},"請選擇",-1),Ls=s("option",{value:"1"},"超商繳費",-1),zs=s("option",{value:"2"},"ATM轉帳",-1),Hs=s("option",{value:"3"},"信用卡",-1),Xs=s("option",{value:"4"},"銀行轉帳",-1),Gs={class:"mb-3"},Js=s("label",{for:"customer-note",class:"form-label"},"備註",-1),Ks={class:"text-end"},Qs=["disabled"];function Ws(l,e,r,Ys,t,g){const w=u("router-link"),m=u("VField"),f=u("ErrorMessage"),k=u("error-message"),C=u("VForm");return a(),d("div",T,[s("div",q,[D,n(w,{to:"/cart",class:"d-inline-flex align-items-center text-decoration-none"},{default:v(()=>[O,M(" 購物車清單 ")]),_:1})]),s("div",R,[L,s("div",z,[s("div",H,[s("div",X,[s("div",G,[J,l.cartNum>0?(a(),d(_,{key:0},[(a(!0),d(_,null,P(l.carts.carts,o=>(a(),d("div",{class:"row g-0 mb-3",key:o.id},[s("div",K,[s("img",{class:"img-fluid object-fit-cover h-100",src:o.product.imageUrl,alt:`Order-Img-${o.id}`},null,8,Q)]),s("div",W,[s("div",Y,[s("div",Z,[s("div",$,[s("p",null,c(o.product.title),1),s("p",null,"X"+c(o.qty),1),s("span",ss,c(o.unit),1)]),s("div",es,[ts,s("span",null,c(l.$filters.currency(o.product.price)),1)]),t.discountStatus?(a(),d(_,{key:0},[o.final_total!==o.total?(a(),d("div",os,[ls,s("small",null,c(l.$filters.currency(o.final_total)),1)])):b("",!0)],64)):b("",!0)])])])]))),128)),s("div",ns,[is,s("div",as,[U(s("input",{type:"text",class:"form-control",id:"coupon","aria-label":"Example text with button addon","aria-describedby":"button-addon1","onUpdate:modelValue":e[0]||(e[0]=o=>t.couponCode=o)},null,512),[[I,t.couponCode]]),s("button",{class:"btn btn-outline-primary",type:"button",id:"button-addon1",onClick:e[1]||(e[1]=N(()=>g.sendCoupon(t.couponCode),["prevent"]))},"套用優惠碼")])])],64)):(a(),d("div",ds,rs)),s("div",ms,[s("div",us,[t.discountStatus?(a(),d(_,{key:0},[_s,s("div",ps,[fs,s("span",hs,c(l.$filters.currency(l.total)),1)]),s("div",vs,[bs,s("span",gs,c(t.discount),1)]),s("div",ys,[xs,s("span",null,c(l.$filters.currency(l.final_total)),1)])],64)):(a(),d(_,{key:1},[l.cartNum>0?(a(),d("div",Vs,[ws,s("span",ks,c(l.$filters.currency(l.total)),1)])):b("",!0)],64))])])])]),n(C,{class:"col-md-6",ref:"form",onSubmit:g.sendOrder},{default:v(({errors:o})=>[s("div",Cs,[Es,s("div",Ss,[As,Ps,n(m,{id:"customer-name",name:"姓名",type:"text",class:p(["form-control",{"is-invalid":o.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:t.form.name,"onUpdate:modelValue":e[2]||(e[2]=i=>t.form.name=i)},null,8,["class","modelValue"]),n(f,{name:"姓名",class:"invalid-feedback"})]),s("div",Us,[Is,Ns,n(m,{name:"email",type:"email",class:p(["form-control",{"is-invalid":o.email}]),id:"customer-emall",placeholder:"請輸入 Email",rules:"email|required",modelValue:t.form.email,"onUpdate:modelValue":e[3]||(e[3]=i=>t.form.email=i)},null,8,["class","modelValue"]),n(f,{name:"email",class:"invalid-feedback"})]),s("div",js,[Ms,Bs,n(m,{name:"電話",type:"tel",class:p(["form-control",{"is-invalid":o.電話}]),id:"customer-phone",placeholder:"0912345678",rules:"required|min:8|max:10",modelValue:t.form.phone,"onUpdate:modelValue":e[4]||(e[4]=i=>t.form.phone=i)},null,8,["class","modelValue"]),n(f,{name:"電話",class:"invalid-feedback"})]),s("div",Fs,[Ts,qs,n(m,{name:"地址",type:"text",class:p(["form-control",{"is-invalid":o.地址}]),id:"customer-address",placeholder:"請輸入地址",rules:"required",modelValue:t.form.address,"onUpdate:modelValue":e[5]||(e[5]=i=>t.form.address=i)},null,8,["class","modelValue"]),n(f,{name:"地址",class:"invalid-feedback"})]),Ds,Os,n(m,{name:"付款方式",class:p(["form-select mb-3",{"is-invalid":o.付款方式}]),id:"customer-pay","aria-label":"Default select example",rules:"required",modelValue:t.form.region,"onUpdate:modelValue":e[6]||(e[6]=i=>t.form.region=i),as:"select"},{default:v(()=>[Rs,Ls,zs,Hs,Xs]),_:2},1032,["class","modelValue"]),n(k,{name:"付款方式",class:"invalid-feedback"}),s("div",Gs,[Js,n(m,{name:"留言",class:"form-control",id:"customer-note",rows:"3",modelValue:t.form.msg,"onUpdate:modelValue":e[7]||(e[7]=i=>t.form.msg=i),as:"textarea"},null,8,["modelValue"])]),s("div",Ks,[s("button",{type:"submit",class:"btn btn-danger",disabled:t.form.email===""||t.form.name===""||t.form.phone===""||t.form.address===""||l.final_total===0},"送出訂單",8,Qs)])])]),_:1},8,["onSubmit"])])])])])}const ee=E(F,[["render",Ws]]);export{ee as default};
