import{_ as A,f as P,m as b,L as U,r as u,o as d,c,b as n,a as s,F as g,g as L,t as i,k as j,E as I,i as M,w as h,h as N,j as y,d as B,n as _}from"./index-8J3nc3ZK.js";import{C as V,s as F}from"./CartStore-hImWOnFT.js";import{S as f}from"./sweetalert2.all-3fSh9583.js";var T={VITE_APP_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_API_NAME:"leo535",BASE_URL:"/flash-taste/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:x,VITE_APP_API_NAME:w}=T,q={data(){return{couponCode:"",discountStatus:!1,discount:0,form:{email:"",name:"",phone:"",address:"",msg:"",region:""}}},methods:{...P(V,["getCarts"]),sendCoupon(l){const e={code:l};this.$http.post(`${x}/api/${w}/coupon`,{data:e}).then(r=>{this.discountStatus=r.data.success,this.discount=Math.round(this.final_total-this.total),f.fire({position:"top-end",icon:"success",title:"已套用優惠券",showConfirmButton:!1,timer:1500}),this.couponCode=""}).catch(r=>(f.fire({position:"top-end",icon:"error",title:r.response.data.message,showConfirmButton:!1,timer:1500}),0))},sendOrder(){const l={user:{name:this.form.name,email:this.form.email,tel:this.form.phone,address:this.form.address},message:this.form.msg};this.axios.post(`${x}/api/${w}/order`,{data:l}).then(e=>{const r=this.$loading.show();console.log(e.data),f.fire({position:"top-end",icon:"success",title:e.data.message,showConfirmButton:!1,timer:1500}),this.$refs.form.resetForm(),this.getCarts(),r.hide(),this.$router.push(`/complete/${e.data.orderId}`)}).catch(e=>{f.fire({position:"top-end",icon:"error",title:e.response.data.message,showConfirmButton:!1,timer:1500})})}},computed:{...b(V,["carts","total","cartNum","final_total"]),...b(F,["isLoading"])},components:{Loading:U},mounted(){this.getCarts()}},D={class:"container"},O=N('<div class="pt-4 pb-3 mb-3"><div class="row justify-content-center"><div class="col-9 col-md-7 timeline"></div></div><div class="row mb-2"><div class="col-3 col-md-5"><div class="timeline-pointer text-center step-1 active"><p>購物清單確認</p></div></div><div class="col-6 col-md-2"><div class="timeline-pointer text-center step-2 active"><p>填寫訂單</p></div></div><div class="col-3 col-md-5"><div class="timeline-pointer text-center step-3"><p>購物完成</p></div></div></div></div>',1),R={class:"row justify-content-center p-3"},z={class:"col-md-12"},G={class:"row"},H={class:"col-lg-5 col-md-6"},J={class:"h-100 p-3 shadow-sm bg-white"},K=s("h3",{class:"text-primary mb-5"},"訂單明細",-1),Q={class:"col-md-4 col-6 position-relative"},W=["src","alt"],X={class:"badge rounded-pill bg-primary position-absolute top-0 start-100 translate-middle fs-6"},Y={class:"col-md-8 col-6 p-2 d-flex flex-column justify-content-center"},Z={class:"row"},$={class:"col-12 d-flex fs-md-5 fs-6"},ss={class:"mb-0 me-auto"},es={class:"col-12"},os={class:"small text-gray"},ts={key:0,class:"row"},ls={key:0,class:"col-12 d-flex justify-content-between text-success"},ns=s("small",null,"折扣價",-1),as={key:1,class:"text-center"},is=s("h2",null,"目前無資料",-1),ds=[is],cs={key:2,class:"row fs-5"},rs=s("div",{class:"col-12 mb-2"},[s("span",{class:"d-block fw-bold text-success"},"已套用優惠券")],-1),ms={class:"col-12 d-flex justify-content-between"},us=s("span",null,"原價:",-1),_s={class:"text-success"},ps={class:"col-12 d-flex justify-content-between mb-2"},fs=s("span",null,"折扣價:",-1),hs={class:"text-success"},vs={class:"col-12 d-flex justify-content-between fs-4 mb-2"},bs=s("span",null,"總計:",-1),gs={key:3,class:"col-12 d-flex justify-content-between fs-4"},ys=s("span",null,"總計:",-1),Vs={class:"text-danger fw-bold"},xs={class:"col-12"},ws={class:"form-group"},Cs=s("label",{for:"coupon",class:"fs-5"},"優惠碼：",-1),ks={class:"input-group mb-3"},Es=s("span",{class:"material-icons"},"keyboard_return",-1),Ss={class:"p-3"},As=s("h3",{class:"text-primary mb-5"},"填寫訂單",-1),Ps={class:"mb-3"},Us=s("span",{class:"text-danger me-1"},"*",-1),Ls=s("label",{for:"customer-name",class:"form-label"},"姓名",-1),js={class:"mb-3"},Is=s("span",{class:"text-danger me-1"},"*",-1),Ms=s("label",{for:"customer-emall",class:"form-label"},"Email",-1),Ns={class:"mb-3"},Bs=s("span",{class:"text-danger me-1"},"*",-1),Fs=s("label",{for:"customer-phone",class:"form-label"},"電話",-1),Ts={class:"mb-3"},qs=s("span",{class:"text-danger me-1"},"*",-1),Ds=s("label",{for:"customer-address",class:"form-label"},"地址",-1),Os=s("span",{class:"text-danger me-1"},"*",-1),Rs=s("label",{for:"customer-pay",class:"form-label"},"付款方式",-1),zs=s("option",{value:"",disabled:""},"請選擇",-1),Gs=s("option",{value:"1"},"超商繳費",-1),Hs=s("option",{value:"2"},"ATM轉帳",-1),Js=s("option",{value:"3"},"信用卡",-1),Ks=s("option",{value:"4"},"銀行轉帳",-1),Qs={class:"mb-3"},Ws=s("label",{for:"customer-note",class:"form-label"},"備註",-1),Xs={class:"text-end"},Ys=["disabled"];function Zs(l,e,r,$s,o,v){const C=u("Loading"),k=u("router-link"),m=u("VField"),p=u("ErrorMessage"),E=u("error-message"),S=u("VForm");return d(),c(g,null,[n(C,{active:l.isLoading,"onUpdate:active":e[0]||(e[0]=t=>l.isLoading=t)},null,8,["active"]),s("div",D,[O,s("div",R,[s("div",z,[s("div",G,[s("div",H,[s("div",J,[K,l.cartNum>0?(d(!0),c(g,{key:0},L(l.carts.carts,t=>(d(),c("div",{class:"row g-0 mb-3 border-1 border-bottom pb-2",key:t.id},[s("div",Q,[s("img",{class:"img-fluid object-fit-cover",src:t.product.imageUrl,alt:`Order-Img-${t.id}`},null,8,W),s("span",X,i(t.qty),1)]),s("div",Y,[s("div",Z,[s("div",$,[s("span",ss,i(t.product.title),1),s("span",null,i(l.$filters.currency(t.product.price)),1)]),s("div",es,[s("span",os,i(t.product.category),1)])]),o.discountStatus?(d(),c("div",ts,[t.final_total!==t.total?(d(),c("div",ls,[ns,s("small",null,i(l.$filters.currency(t.final_total)),1)])):y("",!0)])):y("",!0)])]))),128)):(d(),c("div",as,ds)),o.discountStatus?(d(),c("div",cs,[rs,s("div",ms,[us,s("span",_s,i(l.$filters.currency(l.total)),1)]),s("div",ps,[fs,s("span",hs,i(o.discount),1)]),s("div",vs,[bs,s("span",null,i(l.$filters.currency(l.final_total)),1)])])):(d(),c("div",gs,[ys,s("span",Vs,i(l.$filters.currency(l.total)),1)])),s("div",xs,[s("div",ws,[Cs,s("div",ks,[j(s("input",{type:"text",class:"form-control",id:"coupon","aria-label":"Example text with button addon","aria-describedby":"button-addon1","onUpdate:modelValue":e[1]||(e[1]=t=>o.couponCode=t)},null,512),[[I,o.couponCode]]),s("button",{class:"btn btn-outline-primary",type:"button",id:"button-addon1",onClick:e[2]||(e[2]=M(()=>v.sendCoupon(o.couponCode),["prevent"]))},"套用優惠碼")])])]),n(k,{to:"/cart",class:"d-inline-flex align-items-center text-decoration-none"},{default:h(()=>[Es,B(" 繼續選購 ")]),_:1})])]),n(S,{class:"col-lg-7 col-md-6",ref:"form",onSubmit:v.sendOrder},{default:h(({errors:t})=>[s("div",Ss,[As,s("div",Ps,[Us,Ls,n(m,{id:"customer-name",name:"姓名",type:"text",class:_(["form-control",{"is-invalid":t.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:o.form.name,"onUpdate:modelValue":e[3]||(e[3]=a=>o.form.name=a)},null,8,["class","modelValue"]),n(p,{name:"姓名",class:"invalid-feedback"})]),s("div",js,[Is,Ms,n(m,{name:"email",type:"email",class:_(["form-control",{"is-invalid":t.email}]),id:"customer-emall",placeholder:"請輸入 Email",rules:"email|required",modelValue:o.form.email,"onUpdate:modelValue":e[4]||(e[4]=a=>o.form.email=a)},null,8,["class","modelValue"]),n(p,{name:"email",class:"invalid-feedback"})]),s("div",Ns,[Bs,Fs,n(m,{name:"電話",type:"tel",class:_(["form-control",{"is-invalid":t.電話}]),id:"customer-phone",placeholder:"0912345678",rules:"required|min:8|max:10",modelValue:o.form.phone,"onUpdate:modelValue":e[5]||(e[5]=a=>o.form.phone=a)},null,8,["class","modelValue"]),n(p,{name:"電話",class:"invalid-feedback"})]),s("div",Ts,[qs,Ds,n(m,{name:"地址",type:"text",class:_(["form-control",{"is-invalid":t.地址}]),id:"customer-address",placeholder:"請輸入地址",rules:"required",modelValue:o.form.address,"onUpdate:modelValue":e[6]||(e[6]=a=>o.form.address=a)},null,8,["class","modelValue"]),n(p,{name:"地址",class:"invalid-feedback"})]),Os,Rs,n(m,{name:"付款方式",class:_(["form-select mb-3",{"is-invalid":t.付款方式}]),id:"customer-pay","aria-label":"Default select example",rules:"required",modelValue:o.form.region,"onUpdate:modelValue":e[7]||(e[7]=a=>o.form.region=a),as:"select"},{default:h(()=>[zs,Gs,Hs,Js,Ks]),_:2},1032,["class","modelValue"]),n(E,{name:"付款方式",class:"invalid-feedback"}),s("div",Qs,[Ws,n(m,{name:"留言",class:"form-control",id:"customer-note",rows:"3",modelValue:o.form.msg,"onUpdate:modelValue":e[8]||(e[8]=a=>o.form.msg=a),as:"textarea"},null,8,["modelValue"])]),s("div",Xs,[s("button",{type:"submit",class:"btn btn-danger",disabled:o.form.email===""||o.form.name===""||o.form.phone===""||o.form.address===""||l.final_total===0},"送出訂單",8,Ys)])])]),_:1},8,["onSubmit"])])])])])],64)}const te=A(q,[["render",Zs]]);export{te as default};
