import{S as Y,a as $}from"./swiper-slide-baNuEgwL.js";import{_ as J,f as F,m as H,r as V,o as _,c as T,a as o,b as k,w as y,t as v,i as K,k as Q,v as W,F as C,g as B,l as D,p as Z,e as w}from"./index-Tl3ByFI-.js";import{g as ee,i as te,d as se,n as j,f as O,N as oe}from"./navigation-4jBMbqPD.js";import{C as N}from"./CartStore-0A-0F_bQ.js";import{P as U}from"./ProductStore-L3I9QYZY.js";import{S as z}from"./sweetalert2.all-pUKmrL9Z.js";function ie({swiper:e,extendParams:m,on:f}){m({thumbs:{swiper:null,multipleActiveThumbs:!0,autoScrollOffset:0,slideThumbActiveClass:"swiper-slide-thumb-active",thumbsContainerClass:"swiper-thumbs"}});let P=!1,n=!1;e.thumbs={swiper:null};function S(){const t=e.thumbs.swiper;if(!t||t.destroyed)return;const s=t.clickedIndex,l=t.clickedSlide;if(l&&l.classList.contains(e.params.thumbs.slideThumbActiveClass)||typeof s>"u"||s===null)return;let a;t.params.loop?a=parseInt(t.clickedSlide.getAttribute("data-swiper-slide-index"),10):a=s,e.params.loop?e.slideToLoop(a):e.slideTo(a)}function p(){const{thumbs:t}=e.params;if(P)return!1;P=!0;const s=e.constructor;if(t.swiper instanceof s)e.thumbs.swiper=t.swiper,Object.assign(e.thumbs.swiper.originalParams,{watchSlidesProgress:!0,slideToClickedSlide:!1}),Object.assign(e.thumbs.swiper.params,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper.update();else if(te(t.swiper)){const l=Object.assign({},t.swiper);Object.assign(l,{watchSlidesProgress:!0,slideToClickedSlide:!1}),e.thumbs.swiper=new s(l),n=!0}return e.thumbs.swiper.el.classList.add(e.params.thumbs.thumbsContainerClass),e.thumbs.swiper.on("tap",S),!0}function c(t){const s=e.thumbs.swiper;if(!s||s.destroyed)return;const l=s.params.slidesPerView==="auto"?s.slidesPerViewDynamic():s.params.slidesPerView;let a=1;const d=e.params.thumbs.slideThumbActiveClass;if(e.params.slidesPerView>1&&!e.params.centeredSlides&&(a=e.params.slidesPerView),e.params.thumbs.multipleActiveThumbs||(a=1),a=Math.floor(a),s.slides.forEach(r=>r.classList.remove(d)),s.params.loop||s.params.virtual&&s.params.virtual.enabled)for(let r=0;r<a;r+=1)se(s.slidesEl,`[data-swiper-slide-index="${e.realIndex+r}"]`).forEach(u=>{u.classList.add(d)});else for(let r=0;r<a;r+=1)s.slides[e.realIndex+r]&&s.slides[e.realIndex+r].classList.add(d);const g=e.params.thumbs.autoScrollOffset,x=g&&!s.params.loop;if(e.realIndex!==s.realIndex||x){const r=s.activeIndex;let u,i;if(s.params.loop){const I=s.slides.filter(M=>M.getAttribute("data-swiper-slide-index")===`${e.realIndex}`)[0];u=s.slides.indexOf(I),i=e.activeIndex>e.previousIndex?"next":"prev"}else u=e.realIndex,i=u>e.previousIndex?"next":"prev";x&&(u+=i==="next"?g:-1*g),s.visibleSlidesIndexes&&s.visibleSlidesIndexes.indexOf(u)<0&&(s.params.centeredSlides?u>r?u=u-Math.floor(l/2)+1:u=u+Math.floor(l/2)-1:u>r&&s.params.slidesPerGroup,s.slideTo(u,t?0:void 0))}}f("beforeInit",()=>{const{thumbs:t}=e.params;if(!(!t||!t.swiper))if(typeof t.swiper=="string"||t.swiper instanceof HTMLElement){const s=ee(),l=()=>{const d=typeof t.swiper=="string"?s.querySelector(t.swiper):t.swiper;if(d&&d.swiper)t.swiper=d.swiper,p(),c(!0);else if(d){const g=x=>{t.swiper=x.detail[0],d.removeEventListener("init",g),p(),c(!0),t.swiper.update(),e.update()};d.addEventListener("init",g)}return d},a=()=>{if(e.destroyed)return;l()||requestAnimationFrame(a)};requestAnimationFrame(a)}else p(),c(!0)}),f("slideChange update resize observerUpdate",()=>{c()}),f("setTransition",(t,s)=>{const l=e.thumbs.swiper;!l||l.destroyed||l.setTransition(s)}),f("beforeDestroy",()=>{const t=e.thumbs.swiper;!t||t.destroyed||n&&t.destroy()}),Object.assign(e.thumbs,{init:p,update:c})}function ne({swiper:e,extendParams:m,emit:f,once:P}){m({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function n(){if(e.params.cssMode)return;const c=e.getTranslate();e.setTranslate(c),e.setTransition(0),e.touchEventsData.velocities.length=0,e.freeMode.onTouchEnd({currentPos:e.rtl?e.translate:-e.translate})}function S(){if(e.params.cssMode)return;const{touchEventsData:c,touches:t}=e;c.velocities.length===0&&c.velocities.push({position:t[e.isHorizontal()?"startX":"startY"],time:c.touchStartTime}),c.velocities.push({position:t[e.isHorizontal()?"currentX":"currentY"],time:j()})}function p({currentPos:c}){if(e.params.cssMode)return;const{params:t,wrapperEl:s,rtlTranslate:l,snapGrid:a,touchEventsData:d}=e,x=j()-d.touchStartTime;if(c<-e.minTranslate()){e.slideTo(e.activeIndex);return}if(c>-e.maxTranslate()){e.slides.length<a.length?e.slideTo(a.length-1):e.slideTo(e.slides.length-1);return}if(t.freeMode.momentum){if(d.velocities.length>1){const h=d.velocities.pop(),b=d.velocities.pop(),X=h.position-b.position,R=h.time-b.time;e.velocity=X/R,e.velocity/=2,Math.abs(e.velocity)<t.freeMode.minimumVelocity&&(e.velocity=0),(R>150||j()-h.time>300)&&(e.velocity=0)}else e.velocity=0;e.velocity*=t.freeMode.momentumVelocityRatio,d.velocities.length=0;let r=1e3*t.freeMode.momentumRatio;const u=e.velocity*r;let i=e.translate+u;l&&(i=-i);let I=!1,M;const A=Math.abs(e.velocity)*20*t.freeMode.momentumBounceRatio;let L;if(i<e.maxTranslate())t.freeMode.momentumBounce?(i+e.maxTranslate()<-A&&(i=e.maxTranslate()-A),M=e.maxTranslate(),I=!0,d.allowMomentumBounce=!0):i=e.maxTranslate(),t.loop&&t.centeredSlides&&(L=!0);else if(i>e.minTranslate())t.freeMode.momentumBounce?(i-e.minTranslate()>A&&(i=e.minTranslate()+A),M=e.minTranslate(),I=!0,d.allowMomentumBounce=!0):i=e.minTranslate(),t.loop&&t.centeredSlides&&(L=!0);else if(t.freeMode.sticky){let h;for(let b=0;b<a.length;b+=1)if(a[b]>-i){h=b;break}Math.abs(a[h]-i)<Math.abs(a[h-1]-i)||e.swipeDirection==="next"?i=a[h]:i=a[h-1],i=-i}if(L&&P("transitionEnd",()=>{e.loopFix()}),e.velocity!==0){if(l?r=Math.abs((-i-e.translate)/e.velocity):r=Math.abs((i-e.translate)/e.velocity),t.freeMode.sticky){const h=Math.abs((l?-i:i)-e.translate),b=e.slidesSizesGrid[e.activeIndex];h<b?r=t.speed:h<2*b?r=t.speed*1.5:r=t.speed*2.5}}else if(t.freeMode.sticky){e.slideToClosest();return}t.freeMode.momentumBounce&&I?(e.updateProgress(M),e.setTransition(r),e.setTranslate(i),e.transitionStart(!0,e.swipeDirection),e.animating=!0,O(s,()=>{!e||e.destroyed||!d.allowMomentumBounce||(f("momentumBounce"),e.setTransition(t.speed),setTimeout(()=>{e.setTranslate(M),O(s,()=>{!e||e.destroyed||e.transitionEnd()})},0))})):e.velocity?(f("_freeModeNoMomentumRelease"),e.updateProgress(i),e.setTransition(r),e.setTranslate(i),e.transitionStart(!0,e.swipeDirection),e.animating||(e.animating=!0,O(s,()=>{!e||e.destroyed||e.transitionEnd()}))):e.updateProgress(i),e.updateActiveIndex(),e.updateSlidesClasses()}else if(t.freeMode.sticky){e.slideToClosest();return}else t.freeMode&&f("_freeModeNoMomentumRelease");(!t.freeMode.momentum||x>=t.longSwipesMs)&&(e.updateProgress(),e.updateActiveIndex(),e.updateSlidesClasses())}Object.assign(e,{freeMode:{onTouchStart:n,onTouchMove:S,onTouchEnd:p}})}var ae={VITE_APP_API_URL:"https://ec-course-api.hexschool.io/v2",VITE_APP_API_NAME:"leo535",BASE_URL:"/flash-taste/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_APP_API_URL:q,VITE_APP_API_NAME:G}=ae,le={data(){return{product:{price:0,origin_price:0},productsAll:[],Itemnum:1,thumbsSwiper:null,modules:[ne,oe,ie]}},methods:{getProductSingle(){const{productId:e}=this.$route.params,m=this.$loading.show();this.axios.get(`${q}/api/${G}/product/${e}`).then(f=>{this.product=f.data.product,m.hide()}).catch(f=>{z.fire({position:"top-end",icon:"error",title:f,showConfirmButton:!1,timer:1500})})},getCategory(){this.axios.get(`${q}/api/${G}/products/all`).then(e=>{this.productsAll=e.data.products}).catch(e=>{z.fire({position:"top-end",icon:"error",title:e.response.data.message,showConfirmButton:!1,timer:1500})})},render(e){this.$router.push(`/product/${e}`)},setThumbsSwiper(e){this.thumbsSwiper=e},...F(N,["addToCart"]),...F(U,["addToFavorite","getProductAllData","getid"])},mounted(){this.getProductSingle(),this.getCategory(),this.getProductAllData(),this.getid()},computed:{random(){return this.productsAll.filter(e=>this.product.id!==e.id&&e.category===this.product.category)},...H(U,["favoriteList"]),...H(N,["isLoadingStatus"])},watch:{"$route.params":{immediate:!0,handler(){this.$route.params.productId&&this.getProductSingle()}},$route(e,m){this.$router.go(0)}},components:{Swiper:Y,SwiperSlide:$}},E=e=>(Z("data-v-f9c834df"),e=e(),w(),e),re={class:"container p-4"},de={class:"row"},ce={class:"col-md-6"},ue=["src"],me=["src"],fe={class:"col-md-6"},he={class:"d-flex flex-column justify-content-center"},pe={class:"d-flex justify-content-between align-items-center mb-1"},be={class:"h3 text-nowrap me-2 mb-0 fw-bold"},_e={key:0,class:"bi bi-heart fs-5"},ve={key:1,class:"bi bi-heart-fill fs-5 text-primary"},ge={class:"badge bg-primary mb-1"},Te=["innerHTML"],ye={class:"d-flex flex-column"},Se={class:"align-self-end"},xe={class:"text-decoration-line-through fs-5 text-end"},Me=E(()=>o("span",{class:"me-2"},"原價",-1)),Pe={class:"fs-4 mb-2 fw-bold text-danger"},Ie=E(()=>o("span",{class:"me-2"},"特價",-1)),Ee=E(()=>o("h4",{class:"mb-1"},"商品介紹:",-1)),Ae=["innerHTML"],ke={class:"d-flex justify-content-end mb-2"},Ce=["value"],Be=["disabled"],Le=E(()=>o("div",{class:"row mb-5"},[o("div",{class:"col-md-12"},[o("div",{class:"row d-flex justify-content-center"},[o("div",{class:"col-md-9"})])])],-1)),Ve={class:"row justify-content-center"},De=E(()=>o("h2",{class:"text-center mb-5"},"相關產品",-1)),je={class:"col-md-12"},Oe={class:"swiper-container"},Re={class:"card mb-3 rounded-top"},Fe={class:"product d-block rounded-top"},He=["src"],Ne={class:"card-body p-2"},Ue={class:"card-title fs-4 mb-1"},ze=["innerHTML"],qe={class:"d-flex align-items-end mb-5"},Ge={class:"text-danger fs-4"},Xe={class:"text-black"};function Ye(e,m,f,P,n,S){const p=V("swiper-slide"),c=V("swiper"),t=V("router-link");return _(),T("div",re,[o("div",de,[o("div",ce,[k(c,{style:{"--swiper-navigation-color":"#fff","--swiper-pagination-color":"#fff"},spaceBetween:10,thumbs:{swiper:n.thumbsSwiper},modules:n.modules,navigation:!0,class:"mySwiper-big"},{default:y(()=>[(_(!0),T(C,null,B(n.product.imagesUrl,(s,l)=>(_(),D(p,{key:l},{default:y(()=>[o("img",{class:"object-fit-cover img-fluid",src:s},null,8,ue)]),_:2},1024))),128))]),_:1},8,["thumbs","modules"]),k(c,{onSwiper:S.setThumbsSwiper,spaceBetween:10,slidesPerView:4,freeMode:!0,watchSlidesProgress:!0,modules:n.modules,class:"small-img align-items-center"},{default:y(()=>[(_(!0),T(C,null,B(n.product.imagesUrl,(s,l)=>(_(),D(p,{key:l},{default:y(()=>[o("img",{class:"object-fit-cover img-fluid h-100",src:s},null,8,me)]),_:2},1024))),128))]),_:1},8,["onSwiper","modules"])]),o("div",fe,[o("div",he,[o("div",null,[o("div",pe,[o("h3",be,v(n.product.title),1),o("div",{class:"d-flex mb-md-0 align-items-center text-decoration-none",onClick:m[0]||(m[0]=K(()=>e.addToFavorite(n.product.id),["prevent"])),style:{cursor:"pointer"}},[e.favoriteList.id.indexOf(n.product.id)===-1?(_(),T("span",_e)):(_(),T("span",ve))])]),o("span",ge,v(n.product.category),1),o("div",{style:{"font-weight":"500"},innerHTML:n.product.description},null,8,Te),o("div",ye,[o("div",Se,[o("div",xe,[Me,o("span",null,v(e.$filters.currency(n.product.origin_price)),1)]),o("div",Pe,[Ie,o("span",null,v(e.$filters.currency(n.product.price)),1)])])])])]),Ee,o("div",{innerHTML:n.product.content},null,8,Ae),o("div",ke,[Q(o("select",{class:"form-select me-2",name:"qty","onUpdate:modelValue":m[1]||(m[1]=s=>n.Itemnum=s)},[(_(),T(C,null,B(5,s=>o("option",{value:s,key:s+"0"},v(s)+v(n.product.unit),9,Ce)),64))],512),[[W,n.Itemnum,void 0,{number:!0}]]),o("button",{type:"button",class:"btn btn-primary me-3 me-md-0 text-nowrap",disabled:e.isLoadingStatus.ItemId===n.product.id,onClick:m[2]||(m[2]=()=>e.addToCart(n.product.id,n.Itemnum))}," 加入購物車",8,Be)])])]),Le,o("div",Ve,[De,o("div",je,[o("div",Oe,[k(c,{slidesPerView:3,spaceBetween:24,modules:n.modules,pagination:!0,navigation:"",breakpoints:{320:{slidesPerView:1,spaceBetween:24},768:{slidesPerView:2,spaceBetween:24},992:{slidesPerView:3,spaceBetween:20}}},{default:y(()=>[(_(!0),T(C,null,B(S.random,s=>(_(),D(p,{key:s.id},{default:y(()=>[o("div",Re,[k(t,{class:"text-decoration-none",to:`/product/${s.id}`},{default:y(()=>[o("a",Fe,[o("img",{class:"product-img img-fluid object-fit-cover w-100",src:s.imageUrl,style:{height:"300px"}},null,8,He)]),o("div",Ne,[o("h5",Ue,v(s.title),1),o("p",{class:"text-truncate",innerHTML:s.description},null,8,ze),o("div",qe,[o("span",Ge,v(e.$filters.currency(s.price)),1),o("del",Xe,v(e.$filters.currency(s.origin_price)),1)])])]),_:2},1032,["to"])])]),_:2},1024))),128))]),_:1},8,["modules"])])])])])}const we=J(le,[["render",Ye],["__scopeId","data-v-f9c834df"]]);export{we as default};
